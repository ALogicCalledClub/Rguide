<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 4 Visualisering | Introduktion til R</title>
  <meta name="description" content="Kapitel 4 Visualisering | Introduktion til R" />
  <meta name="generator" content="bookdown 0.21.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 4 Visualisering | Introduktion til R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 4 Visualisering | Introduktion til R" />
  
  
  

<meta name="author" content="Erik Gahner Larsen" />


<meta name="date" content="2020-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="3-data.html"/>
<link rel="next" href="5-ols-regression.html"/>
<script src="libs/header-attrs-2.6.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduktion</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#hvorfor-r-fordele-og-ulemper-ved-r"><i class="fa fa-check"></i><b>1.1</b> Hvorfor R? Fordele og ulemper ved R</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation-af-r-og-rstudio"><i class="fa fa-check"></i><b>1.2</b> Installation af R og RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-basics.html"><a href="2-basics.html"><i class="fa fa-check"></i><b>2</b> Fundamentet</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2-basics.html"><a href="2-basics.html#objekter-og-funktioner"><i class="fa fa-check"></i><b>2.1</b> Objekter og funktioner</a></li>
<li class="chapter" data-level="2.2" data-path="2-basics.html"><a href="2-basics.html#tal-i-objekter"><i class="fa fa-check"></i><b>2.2</b> Tal i objekter</a></li>
<li class="chapter" data-level="2.3" data-path="2-basics.html"><a href="2-basics.html#logiske-operatorer"><i class="fa fa-check"></i><b>2.3</b> Logiske operatorer</a></li>
<li class="chapter" data-level="2.4" data-path="2-basics.html"><a href="2-basics.html#manglende-værdier-na"><i class="fa fa-check"></i><b>2.4</b> Manglende værdier (<code>NA</code>)</a></li>
<li class="chapter" data-level="2.5" data-path="2-basics.html"><a href="2-basics.html#tekst-i-objekter"><i class="fa fa-check"></i><b>2.5</b> Tekst i objekter</a></li>
<li class="chapter" data-level="2.6" data-path="2-basics.html"><a href="2-basics.html#datarammer"><i class="fa fa-check"></i><b>2.6</b> Datarammer</a></li>
<li class="chapter" data-level="2.7" data-path="2-basics.html"><a href="2-basics.html#import-og-eksport-af-datarammer"><i class="fa fa-check"></i><b>2.7</b> Import og eksport af datarammer</a></li>
<li class="chapter" data-level="2.8" data-path="2-basics.html"><a href="2-basics.html#ref-pakker"><i class="fa fa-check"></i><b>2.8</b> Installation af pakker</a></li>
<li class="chapter" data-level="2.9" data-path="2-basics.html"><a href="2-basics.html#objekter-i-hukommelsen"><i class="fa fa-check"></i><b>2.9</b> Objekter i hukommelsen</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-data.html"><a href="3-data.html"><i class="fa fa-check"></i><b>3</b> Databehandling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-data.html"><a href="3-data.html#behandling-af-datarammer-med-dplyr"><i class="fa fa-check"></i><b>3.1</b> Behandling af datarammer med <code>dplyr</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-data.html"><a href="3-data.html#vælg-bestemte-variable-med-select"><i class="fa fa-check"></i><b>3.2</b> Vælg bestemte variable med <code>select()</code></a></li>
<li class="chapter" data-level="3.3" data-path="3-data.html"><a href="3-data.html#vælg-bestemte-observationer-med-filter"><i class="fa fa-check"></i><b>3.3</b> Vælg bestemte observationer med <code>filter()</code></a></li>
<li class="chapter" data-level="3.4" data-path="3-data.html"><a href="3-data.html#vælg-rækkefølgen-på-observationer-med-arrange"><i class="fa fa-check"></i><b>3.4</b> Vælg rækkefølgen på observationer med <code>arrange()</code></a></li>
<li class="chapter" data-level="3.5" data-path="3-data.html"><a href="3-data.html#skift-navnet-på-en-variabel-med-rename"><i class="fa fa-check"></i><b>3.5</b> Skift navnet på en variabel med <code>rename()</code></a></li>
<li class="chapter" data-level="3.6" data-path="3-data.html"><a href="3-data.html#tilføj-variabel-med-mutate"><i class="fa fa-check"></i><b>3.6</b> Tilføj variabel med <code>mutate()</code></a></li>
<li class="chapter" data-level="3.7" data-path="3-data.html"><a href="3-data.html#kombination-af-funktioner-med-pipe-operatoren"><i class="fa fa-check"></i><b>3.7</b> Kombination af funktioner med pipe operatoren</a></li>
<li class="chapter" data-level="3.8" data-path="3-data.html"><a href="3-data.html#kør-funktioner-på-variable-med-apply"><i class="fa fa-check"></i><b>3.8</b> Kør funktioner på variable med <code>apply()</code></a></li>
<li class="chapter" data-level="3.9" data-path="3-data.html"><a href="3-data.html#aggreger-variable-med-summarize"><i class="fa fa-check"></i><b>3.9</b> Aggreger variable med <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-viz.html"><a href="4-viz.html"><i class="fa fa-check"></i><b>4</b> Visualisering</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-viz.html"><a href="4-viz.html#introducerende-eksempel-med-ggplot2"><i class="fa fa-check"></i><b>4.1</b> Introducerende eksempel med <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.2" data-path="4-viz.html"><a href="4-viz.html#specifikationer-med-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Specifikationer med <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.3" data-path="4-viz.html"><a href="4-viz.html#eksempel-venstre-i-meningsmålingerne-i-2015"><i class="fa fa-check"></i><b>4.3</b> Eksempel: Venstre i meningsmålingerne i 2015</a></li>
<li class="chapter" data-level="4.4" data-path="4-viz.html"><a href="4-viz.html#afsluttende-bemærkninger"><i class="fa fa-check"></i><b>4.4</b> Afsluttende bemærkninger</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-ols-regression.html"><a href="5-ols-regression.html"><i class="fa fa-check"></i><b>5</b> OLS regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-ols-regression.html"><a href="5-ols-regression.html#bivariat-analyse"><i class="fa fa-check"></i><b>5.1</b> Bivariat analyse</a></li>
<li class="chapter" data-level="5.2" data-path="5-ols-regression.html"><a href="5-ols-regression.html#multivariat-analyse"><i class="fa fa-check"></i><b>5.2</b> Multivariat analyse</a></li>
<li class="chapter" data-level="5.3" data-path="5-ols-regression.html"><a href="5-ols-regression.html#forudsætningstests"><i class="fa fa-check"></i><b>5.3</b> Forudsætningstests</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5-ols-regression.html"><a href="5-ols-regression.html#linearitet"><i class="fa fa-check"></i><b>5.3.1</b> Linearitet</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-ols-regression.html"><a href="5-ols-regression.html#outliers-og-indflydelsesrige-observationer"><i class="fa fa-check"></i><b>5.3.2</b> Outliers og indflydelsesrige observationer</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-ols-regression.html"><a href="5-ols-regression.html#normalfordelte-fejlled"><i class="fa fa-check"></i><b>5.3.3</b> Normalfordelte fejlled</a></li>
<li class="chapter" data-level="5.3.4" data-path="5-ols-regression.html"><a href="5-ols-regression.html#heteroskedasticitet"><i class="fa fa-check"></i><b>5.3.4</b> Heteroskedasticitet</a></li>
<li class="chapter" data-level="5.3.5" data-path="5-ols-regression.html"><a href="5-ols-regression.html#multikollinaritet"><i class="fa fa-check"></i><b>5.3.5</b> Multikollinaritet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-interaktionsanalyse.html"><a href="6-interaktionsanalyse.html"><i class="fa fa-check"></i><b>6</b> Interaktionsanalyse</a></li>
<li class="chapter" data-level="7" data-path="7-logistisk-regression.html"><a href="7-logistisk-regression.html"><i class="fa fa-check"></i><b>7</b> Logistisk regression</a></li>
<li class="chapter" data-level="8" data-path="8-propensity-score-matching.html"><a href="8-propensity-score-matching.html"><i class="fa fa-check"></i><b>8</b> Propensity Score Matching</a></li>
<li class="chapter" data-level="9" data-path="9-regressionsdiskontinuitetsdesigns.html"><a href="9-regressionsdiskontinuitetsdesigns.html"><i class="fa fa-check"></i><b>9</b> Regressionsdiskontinuitetsdesigns</a></li>
<li class="chapter" data-level="" data-path="konklusion.html"><a href="konklusion.html"><i class="fa fa-check"></i>Konklusion</a>
<ul>
<li class="chapter" data-level="9.1" data-path="konklusion.html"><a href="konklusion.html#pakkeanbefaling-swirl"><i class="fa fa-check"></i><b>9.1</b> Pakkeanbefaling: swirl</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-funktioner.html"><a href="10-funktioner.html"><i class="fa fa-check"></i><b>10</b> Funktioner</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-funktioner.html"><a href="10-funktioner.html#loops"><i class="fa fa-check"></i><b>10.1</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-genveje-og-udvalgte-funktioner.html"><a href="11-genveje-og-udvalgte-funktioner.html"><i class="fa fa-check"></i><b>11</b> Genveje og udvalgte funktioner</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-genveje-og-udvalgte-funktioner.html"><a href="11-genveje-og-udvalgte-funktioner.html#funktioner-1"><i class="fa fa-check"></i><b>11.1</b> Funktioner</a></li>
<li class="chapter" data-level="11.2" data-path="11-genveje-og-udvalgte-funktioner.html"><a href="11-genveje-og-udvalgte-funktioner.html#genveje-i-rstudio"><i class="fa fa-check"></i><b>11.2</b> Genveje i RStudio</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-ref-anpakker.html"><a href="12-ref-anpakker.html"><i class="fa fa-check"></i><b>12</b> Anbefalede pakker</a></li>
<li class="chapter" data-level="13" data-path="13-eksport-af-tabeller.html"><a href="13-eksport-af-tabeller.html"><i class="fa fa-check"></i><b>13</b> Eksport af tabeller</a></li>
<li class="chapter" data-level="14" data-path="14-referencer.html"><a href="14-referencer.html"><i class="fa fa-check"></i><b>14</b> Referencer</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduktion til R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="viz" class="section level1" number="4">
<h1><span class="header-section-number">Kapitel 4</span> Visualisering</h1>
<p>Der er mange måder at præsentere data på. Dette kapitel vil give en introduktion i, hvordan man kan visualisere sine data med R med fokus på pakken <code>ggplot2</code>. Der er tungtvejende grunde til at fokusere på at visualisere sine data, og i samfundsvidenskaberne er der kommet fokus på vigtigheden af at præsentere sine resultater i figurer i stedet for tabeller <span class="citation">Schwabish (2014)</span>.</p>
<p><span class="citation">Field, Miles, &amp; Field (2012)</span> har beskrevet det som følger: “Data analysis is a bit like Internet dating (actually it’s not, but bear with me): you can scan through the vital statistics and find a perfect match (good IQ, tall, physically fit, likes arty French films, etc.) and you’ll think you have found the perfect answer to your question. However, if you haven’t looked at a picture, then you don’t really know how to interpret this information […] Data analysis is much the same: inspect your data with a picture, see how it looks and only then think about interpreting the more vital statistics.” (side 117)</p>
<p>Et kendt eksempel på det nyttige i at visualisere sine data gives af <span class="citation">Anscombe (1973)</span>. Tabel <a href="4-viz.html#tab:anscombe">4.1</a> viser udvalgte resultater fra fire forskellige bivariate regressionsmodeller. Som det kan ses, er resultaterne identiske for de fire modeller.</p>
<table>
<caption><span id="tab:anscombe">Table 4.1: </span> Anscombe’s kvadrant, resultater</caption>
<thead>
<tr class="header">
<th></th>
<th>Model 1</th>
<th>Model 2</th>
<th>Model 3</th>
<th>Model 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_{0}\)</span> (se)</td>
<td>3,00 (1,12)</td>
<td>3,00 (1,13)</td>
<td>3,00 (1,13)</td>
<td>3,00 (1,12)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_{1}\)</span> (se)</td>
<td>0,50 (0,12)</td>
<td>0,50 (0,12)</td>
<td>0,50 (0,12)</td>
<td>0,50 (0,12)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(R^{2}\)</span></td>
<td>0,63</td>
<td>0,63</td>
<td>0,63</td>
<td>0,63</td>
</tr>
<tr class="even">
<td><span class="math inline">\(N\)</span></td>
<td>11</td>
<td>11</td>
<td>11</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>Kigger vi omvendt på, hvordan forholdet er mellem den uafhængige og afhængige variabel i de fire modeller, som illustreret i Figur <a href="4-viz.html#fig:anscombe">4.1</a>, ser vi, at der er nævneværdige forskelle på de forskellige modeller, som ikke kommer til syne ved at kigge på nogle af de estimater, vi som regel er mest interesserede i, når vi arbejder med regressionsanalyser<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.</p>
<div class="figure" style="text-align: center"><span id="fig:anscombe"></span>
<img src="Rguide_files/figure-html/anscombe-1.png" alt="Anscombes kvadrant" width="480" />
<p class="caption">
Figure 4.1: Anscombes kvadrant
</p>
</div>
<p>Ovenstående figur er lavet med R uden brug af nogle pakker, og dette fungerer fint og kan fungere ganske godt i de fleste tilfælde. Det er dog ofte yderst besværligt (altså tidskrævende) at lave pæne figurer på denne måde, og det script man ligeledes bygger op kan være svært for andre at læse, hvis man laver mere komplicerede figurer. Heldigvis er der en fantastisk pakke til R kaldet <code>ggplot2</code> <span class="citation">(H. Wickham, 2009)</span>, der gør det nemt at lave pænere figurer i R. Det er dog vigtigt at nævne, at <code>ggplot2</code> ikke nødvendigvis er bedre end så mange andre pakker til at lave figurer, hvorfor det delvist handler om ens personlige præference. Ligeledes er der også funktioner i <code>ggplot2</code>, som det vil blive anbefalet <em>ikke</em> at bruge, herunder især funktionen <code>qplot()</code>, der står for <em>quick plot</em>, men som er ganske overflødig. <code>ggplot2</code> bruges dog af flere og flere, hvorfor der også er mange gode ressourcer, der gør det nemt at lave pæne figurer.</p>
<div id="introducerende-eksempel-med-ggplot2" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introducerende eksempel med <code>ggplot2</code></h2>
<p>I nærværende kapitel vil vi først kigge på et simpelt eksempel, der viser, hvordan man kan lave figurer med <code>ggplot2</code> i R<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>. Til dette formål vil vi bruge datasættet <code>ft2015.csv</code>, som vi genererede i forrige kapitel<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>. Vi indlæser datasættet med funktionen <code>read.csv()</code>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="4-viz.html#cb134-1" aria-hidden="true" tabindex="-1"></a>pol <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/ft2015.csv&quot;</span>)</span></code></pre></div>
<p>Hvis vi gerne vil vise relationen mellem hvor mange stemmer et parti har fået ved folketingsvalget og dets mandater i Folketinget, kan vi bruge funktionen <code>plot()</code> i R, der er en del af basispakken og dermed ikke kræver at en pakke indlæses.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="4-viz.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pol<span class="sc">$</span>vote, pol<span class="sc">$</span>seat)</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-75-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Et lignende plot kan vi lave med <code>ggplot2</code>, hvorfor vi først åbner pakken i R med <code>library()</code>.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="4-viz.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>Til at lave et plot a la ovenstående med <code>ggplot2</code> bruger vi funktionen <code>ggplot()</code>. Med <code>ggplot()</code> specificerer vi først hvilken dataramme, vi ønsker at anvende, samt hvilke variable i datarammen, der skal visualiseres (bemærk at <code>ggplot()</code> <em>altid</em> tager udgangspunkt i en dataramme). Det er med andre ord her, at vi angiver, hvilke variable der skal visualiseres samt deres rolle (evt. om variablen skal være på x-aksen eller y-aksen). Hvis vi eksempelvis har en dataramme med en <code>variabel1</code> og <code>variabel2</code>, kan specifikationen se ud som følger:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="4-viz.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dataramme, <span class="fu">aes</span>(<span class="at">x=</span>variabel1, <span class="at">y=</span>variabel2))</span></code></pre></div>
<p>Her har vi således angivet, at vi er interesseret i <code>variabel1</code> og <code>variabel2</code>, samt at førstnævnte er en x-akse variabel og sidstnævnte er en y-akse variabel. Vi har endnu ikke specificeret, hvilken type figur, vi ønsker at lave. Dette kan vi tilføje ved først at lave et <code>+</code> tegn, og så angive, hvilken figur vi ønsker at lave (i dette tilfælde et punktdiagram):</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="4-viz.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dataramme, <span class="fu">aes</span>(<span class="at">x=</span>variabel1, <span class="at">y=</span>variabel2)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="4-viz.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>Dette er grundideen med <code>ggplot2</code>. Først angiver vi, hvilke data vi er interesseret i at arbejde med, og så tilføjer vi ekstra specifikationer efter forgodtbefindende. Vi kan således tilføje information om, hvad der skal stå på akserne, hvor store punkterne skal være og så videre. En af fordelene ved denne tilgang er, at du først kan lave noget meget simpelt, og så derefter redigere i dette, til du til sidst opnår det ønskede resultat. Dette er uanset om du vælger at lave et søjlediagram, en punktdiagram eller noget helt tredje.</p>
<p>Dette kan virke uoverskueligt, men der er en mening med galskaben (en mening der kun bliver mere klar, jo mere man arbejder med det). De to g’er (altså <code>gg</code>) i <code>ggplot2</code> står for <em>grammar of graphics</em>, og det er hele filosofien bag, altså at der skal være en sætningsstruktur til de figurer, man laver. Med andre ord består vores figur af forskellige komponenter. Har vi først lavet én figur, kan vi bygge videre på denne, eksempelvis ved at tilføje linjer og ændre farvetema, tekst med videre.</p>
<p>Vi kan således bruge <code>ggplot2</code> til at lave en figur som ovenfor. Først specificerer vi, at vi er interesseret i at bruge datarammen <code>pol</code>, hvor x-aksen skal være <code>vote</code> og y-aksen <code>seat</code>. Dernæst siger vi at det skal være punkter (<code>geom_point</code>), vi gerne vil have visualiseret.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="4-viz.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pol, <span class="fu">aes</span>(<span class="at">x=</span>vote, <span class="at">y=</span>seat)) <span class="sc">+</span></span>
<span id="cb139-2"><a href="4-viz.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-79-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Dette er dog ikke nødvendigvis vores færdige figur. Tværtimod kan vi som nævnt tilføje flere komponenter. Lad os begyndte med blot at ændre temaet, så vi får et mere minimalistisk <em>look</em>. Dette gøres med tilføjelsen <code>theme_minimal()</code>. Bemærk desuden at de forskellige komponenter adskilles med <code>+</code>, men at det ikke er et krav, at de er på en ny linje.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="4-viz.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pol, <span class="fu">aes</span>(<span class="at">x=</span>vote, <span class="at">y=</span>seat)) <span class="sc">+</span></span>
<span id="cb140-2"><a href="4-viz.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb140-3"><a href="4-viz.html#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-80-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Dette er blot for at vise logikken bag <code>ggplot2</code>. Det kan virke kompliceret, men undlad at give op. Jo flere figurer du laver, gerne helt fra bunden, desto nemmere bliver det med tiden. Husk desuden også, at Google er en fantastisk ressource i denne sammenhæng, og hvis du søger efter <code>ggplot2</code> og det du gerne vil lave, vil der i de fleste tilfælde komme resultater op, der vil hjælpe dig. Der er som sagt ingen grænse for, hvad man kan bygge på og ændre i, og i nedenstående kan det ses, at der er tilføjet en række ekstra linjer, der hver især tjener et formål i forhold til figuren.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="4-viz.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pol, <span class="fu">aes</span>(<span class="at">x=</span>vote, <span class="at">y=</span>seat)) <span class="sc">+</span></span>
<span id="cb141-2"><a href="4-viz.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb141-3"><a href="4-viz.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span><span class="fu">as.factor</span>(rw)), <span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb141-4"><a href="4-viz.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb141-5"><a href="4-viz.html#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mandater&quot;</span>) <span class="sc">+</span></span>
<span id="cb141-6"><a href="4-viz.html#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Stemmer (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb141-7"><a href="4-viz.html#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">ifelse</span>(party <span class="sc">==</span> <span class="st">&quot;Socialdemokraterne&quot;</span>, </span>
<span id="cb141-8"><a href="4-viz.html#cb141-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Socialdemokraterne&quot;</span>,<span class="st">&quot;&quot;</span>), </span>
<span id="cb141-9"><a href="4-viz.html#cb141-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">hjust=</span><span class="fl">1.1</span>, <span class="at">vjust=</span><span class="fl">0.5</span>), <span class="at">size=</span><span class="fl">4.5</span>)</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-81-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Ovenstående plot illustrerer blot den måde hvorpå <code>ggplot2</code> fungerer. I nærværende tilfælde ville det ikke være nødvendigt at visualisere forholdet mellem stemmer og mandater, da det er begrænset hvor meget anden information der kommer ud af figuren, end ved blot at formidle korrelationen.</p>
<p>Det bedste råd der kan gives i forhold til brugen af <code>ggplot2</code> pakken er, at lære det grundlæggende (altså hvordan man laver et histogram og andre figurer) og derfra så gradvist lære at bygge ovenpå (eksempelvis gennem Google), når der er problemer eller bestemte ønsker.</p>
</div>
<div id="specifikationer-med-ggplot2" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Specifikationer med <code>ggplot2</code></h2>
<p>I dette afsnit introduceres vigtig terminologi, og mere specifikt hvordan <code>ggplot2</code> fungerer med geometriske objekter og æstetiske tilføjelser. Alle plots lavet med <code>ggplot2</code> laves med funktionen <code>ggplot()</code>. I denne funktion angives det først, som beskrevet i forrige afsnit, hvilken dataramme, man anvender, hvorefter det angives hvilke variable, man er interesseret i. Ønsker man blot at vise en distribution af én variabel, er det selvsagt tilstrækkeligt blot at angive én variabel. De variable der skal visualiseres <em>skal</em> være en del af en dataramme.</p>
<p>Der er et utal af muligheder med <code>ggplot2</code>, og således også flere ting, der kan specificeres. Alt efter hvilken type figur, vi ønsker at lave, skal vi vælge en bestemt <code>geom</code>, der er et geometrisk objekt. Det er denne specifikation, der fortæller, om vi er interesseret i et histogram, et punktdiagram eller noget helt tredje.</p>
<p>Tabel <a href="4-viz.html#tab:ggplot2">4.2</a> viser udvalgte geometriske objekter, der ofte anvendes. Foruden objektnavn er der angivet et link til hvert objekt, hvor man kan læse mere om de respektive objekter og se illustrative eksempler på, hvordan de fungerer.</p>
<table>
<caption><span id="tab:ggplot2">Table 4.2: </span> Udvalgte geometriske objekter i ggplot2</caption>
<thead>
<tr class="header">
<th>Navn</th>
<th>Funktion</th>
<th>Side: Cookbook for R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bar plot</td>
<td><code>geom_bar()</code></td>
<td><a href="http://www.cookbook-r.com/Graphs/Bar_and_line_graphs_(ggplot2)/">Bar and line graphs</a></td>
</tr>
<tr class="even">
<td>Boxplot</td>
<td><code>geom_boxplot()</code></td>
<td><a href="http://www.cookbook-r.com/Graphs/Plotting_distributions_(ggplot2)/">Plotting distributions</a></td>
</tr>
<tr class="odd">
<td>Densitetsplot</td>
<td><code>geom_density()</code></td>
<td><a href="http://www.cookbook-r.com/Graphs/Plotting_distributions_(ggplot2)/">Plotting distributions</a></td>
</tr>
<tr class="even">
<td>Histogram</td>
<td><code>geom_histogram()</code></td>
<td><a href="http://www.cookbook-r.com/Graphs/Plotting_distributions_(ggplot2)/">Plotting distributions</a></td>
</tr>
<tr class="odd">
<td>Punktdiagram</td>
<td><code>geom_point()</code></td>
<td><a href="http://www.cookbook-r.com/Graphs/Scatterplots_(ggplot2)/">Scatterplots</a></td>
</tr>
</tbody>
</table>
<p>Det næste vi skal have styr på, er det æstetiske. Her anvendes <code>aes()</code> (forkortelse af <em>aesthetic</em>). Her specificeres det, hvilke variable vi skal visualisere m.v. Det er således også her det angives, hvis observationer skal have forskellige farver.</p>
<p>Som det kunne ses ovenfor, er der et standardtema, som <code>ggplot2</code> anvender. Der er tale om en karakteristik grå baggrund, som ikke er decideret grim, men nemt kan ændres, hvis man vil have noget mere simpelt (eller bare noget andet).</p>
<p>Tabel <a href="4-viz.html#tab:ggthemes">4.3</a> viser en rækkke udvalgte temaer der er at finde i hhv. <code>ggplot2</code>
og <a href="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html"><code>ggthemes</code></a>. Det er kun udvalgte temaer, og <code>ggthemes</code> har eksempelvis også <code>theme_stata()</code>, og det siger sig selv, at dette tema <em>aldrig</em> skal anvendes.</p>
<table>
<caption><span id="tab:ggthemes">Table 4.3: </span> Udvalgte temaer til i ggplot2</caption>
<thead>
<tr class="header">
<th>Funktion</th>
<th>Pakke</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>theme_bw()</td>
<td><code>ggplot2</code></td>
<td>Mørke elementer på hvid baggrund</td>
</tr>
<tr class="even">
<td>theme_minimal()</td>
<td><code>ggplot2</code></td>
<td>Minimalistisk tema</td>
</tr>
<tr class="odd">
<td>theme_classic()</td>
<td><code>ggplot2</code></td>
<td>Tema uden gitterlinjer</td>
</tr>
<tr class="even">
<td>theme_base()</td>
<td><code>ggthemes</code></td>
<td>Kopi af base tema i R</td>
</tr>
<tr class="odd">
<td>theme_economist()</td>
<td><code>ggthemes</code></td>
<td>The Economist tema</td>
</tr>
<tr class="even">
<td>theme_fivethirtyeight()</td>
<td><code>ggthemes</code></td>
<td>FiveThirtyEight tema</td>
</tr>
<tr class="odd">
<td>theme_tufte()</td>
<td><code>ggthemes</code></td>
<td><span class="citation">Tufte (1983)</span> tema</td>
</tr>
</tbody>
</table>
<p>Figur <a href="4-viz.html#fig:ggthemes">4.2</a> viser hvordan de forskellige <em>themes</em> ser ud. Rækkefølgen er: Standard, <code>theme_bw()</code>, <code>theme_minimal()</code>, <code>theme_classic()</code>, <code>theme_base()</code>, <code>theme_economist()</code>, <code>theme_fivethirtyeight()</code>, <code>theme_tufte()</code>.</p>
<div class="figure" style="text-align: center"><span id="fig:ggthemes"></span>
<img src="Rguide_files/figure-html/ggthemes-1.png" alt="Otte forskellige temaer" width="480" />
<p class="caption">
Figure 4.2: Otte forskellige temaer
</p>
</div>
<p>Der findes flere ressourcer online, der beskæftiger sig med temaer til ggplot2, og foruden ovenstående kan <a href="https://github.com/cttobin/ggthemr">ggthemr</a> og <a href="https://www.ggplot2-exts.org/">ggplot2 extensions</a> anbefales.</p>
</div>
<div id="eksempel-venstre-i-meningsmålingerne-i-2015" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Eksempel: Venstre i meningsmålingerne i 2015</h2>
<p>I dette afsnit gives flere eksempler på, hvordan man kan bygge figurer op. Idéen er ikke, at du efter at have læst dette afsnit kan - eller skal kunne - lave lignende figurer, men at du har en klar idé om hvordan figurer laves og kan finde inspiration i nedenstående, når du laver dine egne figurer.</p>
<p>Til dette vil vi bruge datasættet <code>polls.csv</code>, der indeholder data på en lang række meningsmålinger, der viser opbakningen til de partier, der enten er i Folketinget eller arbejder på at komme det. Vi bruger igen kommandoen <code>read.csv()</code> til at indlæse vores datasæt. Vi gemmer det i objektet <code>polls</code>:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="4-viz.html#cb142-1" aria-hidden="true" tabindex="-1"></a>polls <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/polls.csv&quot;</span>)</span></code></pre></div>
<p>Først skal vi have et overblik over datasætte. Til at gøre dette bruger vi <code>summary()</code>:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="4-viz.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(polls)</span></code></pre></div>
<pre><code>       id       pollingfirm             year          month       
 Min.   :   1   Length:1013        Min.   :2010   Min.   : 1.000  
 1st Qu.: 254   Class :character   1st Qu.:2011   1st Qu.: 4.000  
 Median : 507   Mode  :character   Median :2013   Median : 6.000  
 Mean   : 507                      Mean   :2013   Mean   : 6.563  
 3rd Qu.: 760                      3rd Qu.:2015   3rd Qu.: 9.000  
 Max.   :1013                      Max.   :2016   Max.   :12.000  
                                                                  
      day           party_a         party_b          party_c      
 Min.   : 1.00   Min.   :14.40   Min.   : 3.300   Min.   : 2.100  
 1st Qu.: 8.00   1st Qu.:20.30   1st Qu.: 5.500   1st Qu.: 3.500  
 Median :13.00   Median :24.20   Median : 7.600   Median : 4.200  
 Mean   :15.13   Mean   :23.29   Mean   : 7.277   Mean   : 4.509  
 3rd Qu.:23.00   3rd Qu.:26.10   3rd Qu.: 8.725   3rd Qu.: 5.225  
 Max.   :31.00   Max.   :31.50   Max.   :11.700   Max.   :12.700  
                 NA&#39;s   :1       NA&#39;s   :1        NA&#39;s   :1       
    party_d         party_f          party_i         party_k      
 Min.   :1.000   Min.   : 2.400   Min.   :0.200   Min.   :0.0000  
 1st Qu.:1.800   1st Qu.: 4.775   1st Qu.:4.700   1st Qu.:0.5000  
 Median :2.700   Median : 6.100   Median :5.500   Median :0.7000  
 Mean   :2.792   Mean   : 7.256   Mean   :5.682   Mean   :0.7072  
 3rd Qu.:3.600   3rd Qu.: 7.900   3rd Qu.:6.900   3rd Qu.:0.9000  
 Max.   :5.600   Max.   :19.400   Max.   :9.500   Max.   :1.5000  
 NA&#39;s   :988     NA&#39;s   :1        NA&#39;s   :1       NA&#39;s   :624     
    party_o         party_v         party_oe         party_aa    
 Min.   : 9.90   Min.   :14.50   Min.   : 2.100   Min.   :0.900  
 1st Qu.:13.40   1st Qu.:20.60   1st Qu.: 7.200   1st Qu.:3.600  
 Median :17.10   Median :23.50   Median : 8.600   Median :4.800  
 Mean   :16.73   Mean   :24.51   Mean   : 8.349   Mean   :4.709  
 3rd Qu.:19.60   3rd Qu.:28.40   3rd Qu.: 9.800   3rd Qu.:6.000  
 Max.   :24.50   Max.   :36.40   Max.   :14.900   Max.   :9.300  
 NA&#39;s   :1       NA&#39;s   :1       NA&#39;s   :1        NA&#39;s   :689    
       n           source         
 Min.   : 717   Length:1013       
 1st Qu.:1016   Class :character  
 Median :1050   Mode  :character  
 Mean   :1259                     
 3rd Qu.:1500                     
 Max.   :5503                     
 NA&#39;s   :65                       </code></pre>
<p>Som det kan ses har vi en lang række af variable i vores dataramme <code>polls</code>. <code>id</code>, der giver hver observation et id. <code>pollingfirm</code>, der angiver hvilket analyseinstitut, der har foretaget meningsmålingen. <code>year</code>, <code>month</code> og <code>day</code> angiver henholdsvis årstal, måned og dag for, hvornår dataindsamlingen for meningsmålingen blev fuldført. I vores datasæt har vi, som det kan ses, observationer i perioden fra 2010 til 2016. De næste variable angiver opbakningen til de forskellige partier, hvor de begynder med præfikset <code>party_</code> og dernæst partibogstavet. <code>party_v</code> er således partiet Venstres opbakning i meningsmålingen. Sidst har vi variablen <code>n</code>, der angiver hvor mange der er blevet spurgt, og til sidst <code>source</code>, der angiver, hvor informationerne er fra.</p>
<p>Vi kan begynde med at lave et histogram over, hvor mange respondenter der normalt bliver spurgt i meningsmålingerne.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="4-viz.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(polls, <span class="fu">aes</span>(<span class="at">x=</span>n)) <span class="sc">+</span> </span>
<span id="cb145-2"><a href="4-viz.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-84-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Som vi kan se spørger de fleste meningsmålinger omkring 1000 personer. Dette harmonerer fint med vores deskriptive statistik i ovenstående, hvor vi kunne se, at medianen var 1050.</p>
<p>Som det næste kan vi se på, hvilke institutter der har gennemført meningsmålingerne i vores datasæt. Til dette bruger vi <code>geom_bar()</code> i stedet for <code>geom_histogram</code>, og så tilføjer vi <code>theme_minimal()</code>, blot for at gøre figuren lidt pænere:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="4-viz.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(polls, <span class="fu">aes</span>(<span class="at">x=</span>pollingfirm)) <span class="sc">+</span> </span>
<span id="cb146-2"><a href="4-viz.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb146-3"><a href="4-viz.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-85-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Som det kan ses gennemfører Voxmeter flest meningsmålinger i denne periode (hvilket skyldes, at Voxmeter normalt foretager en meningsmåling om ugen). Vi kan også se på, hvordan partierne i hele perioden ligger hos de respektive analyseinstitutter. I nedenstående laver vi et boxplot med information om, hvordan partiet Venstre normalt ligger.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="4-viz.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(polls, <span class="fu">aes</span>(<span class="at">x=</span>pollingfirm, <span class="at">y=</span>party_v)) <span class="sc">+</span> </span>
<span id="cb147-2"><a href="4-viz.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb147-3"><a href="4-viz.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-86-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Det kan ses, at især Rambøll har Venstre højere oppe. Det skyldes dog ikke, at Rambøll overvurderer Venstre, men at meningsmålingerne fra Rambøll er fra tidligt i perioden (hvor Venstre lå højere i meningsmålingerne). Derfor er vi også interesseret i at kigge på Venstres opbakning over tid, hvor vi i nærværende tilfælde indskrænker os til 2015. For at gøre dette laver vi først en ny variabel, <code>date</code>, der samler information fra <code>year</code>, <code>month</code> og <code>day</code> og så indskrænker datasættet i objektet <code>polls.2015</code> til kun at have meningsmålingerne fra 2015.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="4-viz.html#cb148-1" aria-hidden="true" tabindex="-1"></a>polls<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="fu">paste</span>(polls<span class="sc">$</span>year, </span>
<span id="cb148-2"><a href="4-viz.html#cb148-2" aria-hidden="true" tabindex="-1"></a>                                     polls<span class="sc">$</span>month, </span>
<span id="cb148-3"><a href="4-viz.html#cb148-3" aria-hidden="true" tabindex="-1"></a>                                     polls<span class="sc">$</span>day,</span>
<span id="cb148-4"><a href="4-viz.html#cb148-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sep=</span><span class="st">&quot;-&quot;</span>)), <span class="at">by =</span> <span class="st">&quot;days&quot;</span>))</span>
<span id="cb148-5"><a href="4-viz.html#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="4-viz.html#cb148-6" aria-hidden="true" tabindex="-1"></a>polls<span class="fl">.2015</span> <span class="ot">&lt;-</span> polls[polls<span class="sc">$</span>date <span class="sc">&gt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb148-7"><a href="4-viz.html#cb148-7" aria-hidden="true" tabindex="-1"></a>                 polls<span class="sc">$</span>date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-12-31&quot;</span>),]</span></code></pre></div>
<p>Dette kan vi illustrere med nedenstående kode. Bemærk at vi her også angiver, at <code>date</code> er en datovariabel (med <code>as.Date()</code>). Ligeledes tilføjer vi nogle andre specifikationer, der gør figuren lidt pænere og informativ.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="4-viz.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(polls<span class="fl">.2015</span>, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.Date</span>(date), <span class="at">y=</span>party_v)) <span class="sc">+</span> </span>
<span id="cb149-2"><a href="4-viz.html#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb149-3"><a href="4-viz.html#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Venstres opbakning i meningsmålingerne, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb149-4"><a href="4-viz.html#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Stemmer (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb149-5"><a href="4-viz.html#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="st">&quot;&quot;</span>, <span class="at">date_labels =</span> <span class="fu">c</span>(<span class="st">&quot;%b&quot;</span>)) <span class="sc">+</span></span>
<span id="cb149-6"><a href="4-viz.html#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-88-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Figuren viser alle meningsmålingerne i 2015. Hvis vi gerne vil vise dem for de enkelte analyseinstitutter, kan vi bruge funktionen <code>facet_wrap()</code> og angive, at vi skal have en figur for hver kategori i <code>pollingfirm</code> og vil have dem vist i to kolonner:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="4-viz.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(polls<span class="fl">.2015</span>, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.Date</span>(date), <span class="at">y=</span>party_v)) <span class="sc">+</span> </span>
<span id="cb150-2"><a href="4-viz.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb150-3"><a href="4-viz.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Venstres opbakning i meningsmålingerne, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-4"><a href="4-viz.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Stemmer (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-5"><a href="4-viz.html#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="st">&quot;&quot;</span>, <span class="at">date_labels =</span> <span class="fu">c</span>(<span class="st">&quot;%b&quot;</span>)) <span class="sc">+</span></span>
<span id="cb150-6"><a href="4-viz.html#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb150-7"><a href="4-viz.html#cb150-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> pollingfirm, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Rguide_files/figure-html/unnamed-chunk-89-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="afsluttende-bemærkninger" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Afsluttende bemærkninger</h2>
<p>Nærværende kapitel har givet en introduktion til nogle af de grundlæggende elementer i, hvordan man visualiserer datarammer med <code>ggplot2</code>-pakken i <code>R</code>. Når du har lavet en figur, er det ofte også nødvendigt at eksportere den, altså få den gemt, så du kan inkludere den i dit arbejde. Til at gemme et plot bruger vi kommandoen <code>ggsave()</code>:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="4-viz.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;filnavn.png&quot;</span>)</span></code></pre></div>
<p>Figuren vil blive gemt i dit <em>working directory</em>. Filtypen <code>.png</code> kan erstattes med andre formater, du skulle have interesse i. Hvis du har gemt figuren i et objekt, eksempelvis objektet <code>plot.1</code>, kan du også angive dette før selve angivelsen af filen:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="4-viz.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot<span class="fl">.1</span>, <span class="st">&quot;filnavn.png&quot;</span>)</span></code></pre></div>
<p>Når du har gemt din figur, vil du i mange tilfælde se, at du ikke er helt tilfreds med højden og bredden på figuren. Dette kan du ændre ved hjælp af specifikationerne <code>width</code> og <code>height</code>:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="4-viz.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot<span class="fl">.1</span>, <span class="st">&quot;filnavn.png&quot;</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Der er to pointer, der er vigtige at afslutte nærværende kapitel med. For det første, overordnet set, er det vigtigt at huske på, at man i en visualisering ikke oversælger sine data (eller modelestimater). <span class="citation">Tufte (1983)</span> opererer med begrebet løgnfaktor, der er effektstørrelsen i ens grafik divideret med effektstørrelsen i ens data. Der skal i ens præsentation gerne være en løgnfaktor på 1, altså en retmæssig præsentation af, hvad ens data rent faktisk viser.</p>
<p>For det andet har hensigten med dette kapitel været at give et indblik i, hvad man kan med <code>ggplot2</code>. Kapitlet er på ingen måde udtømmende, og der findes talrige guides på nettet, der mindst lige så godt som dette kapitel, klæder dig på til at visualisere data med <code>ggplot2</code> i R. Disse inkluderer blandt andet:</p>
<ul>
<li><a href="http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html">Introduction to R Graphics with ggplot2</a></li>
<li><a href="https://matthewdharris.com/2016/08/12/ggplot2-step-by-step/">Building a ggplot2 step by step</a></li>
<li><a href="http://minimaxir.com/2015/02/ggplot-tutorial/">An Introduction on How to Make Beautiful Charts With R and ggplot2</a></li>
<li><a href="http://moc.environmentalinformatics-marburg.de/gitbooks/publicationQualityGraphics/_book/chapters/02_data_visualisation/scatter_ggplot2.html">Scatter plots (ggplot2 way)</a></li>
</ul>
<p>Som den sidste ressource kan officielle dokumentation anbefales, der har en oversigt over alle <em>geoms</em>, <em>statistics</em>, <em>scales</em>, <em>aesthetics</em> osv.: <a href="http://docs.ggplot2.org/current/">docs.ggplot2.org/current/</a></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>For et andet godt eksempel, se indlægget <a href="http://janhove.github.io/teaching/2016/11/21/what-correlations-look-like">What data patterns can lie behind a correlation coefficient?</a>.<a href="4-viz.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>For installation af pakken, se sektion <a href="2-basics.html#ref-pakker">2.8</a>.<a href="4-viz.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>De datasæt vi arbejder med i løbet af bogen kan ligeledes findes på GitHub: <a href="https://github.com/erikgahner/Rguide/tree/master/data">github.com/erikgahner/Rguide/tree/master/data</a><a href="4-viz.html#fnref13" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="5-ols-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
